---
title: A Bayesian Record Linkage Approach to Tree Demography Using Overlapping LiDAR Scans
author: 
  - name: Lane Drew
    shortname: Drew L.,
    numaddress: 1
    corresponding: true
  - name: Andee Kaplan
    shortname: Kaplan A., and
    numaddress: 1
    corresponding: false
  - name: Ian Breckheimer
    shortname: Breckheimer I.
    numaddress: 2
    corresponding: false
corresponding: true
corresponding_name: Lane Drew
corresponding_address: Department of Statistics, Colorado State University, Fort Collins, Colorado 80523-1877
corresponding_email: lane.drew@colostate.edu
output: 
  pdf_document: 
    keep_tex: false
    template: "../paper/aoas-template.tex"
    includes:
        in_header: "../paper/preamble_common.tex"
bibliography: "../paper/References-Lib.bib"
abstract: In the information age, it has become increasingly common for data containing records about overlapping individuals to be distributed across multiple sources, making it necessary to identify which records refer to the same individual. The goal of record linkage is to estimate this unknown structure in the absence of a unique identifiable attribute. We introduce a Bayesian hierarchical record linkage model for spatial location data motivated by the estimation of population growth curves for conifer species using data derived from overlapping LiDAR scans taken at regular time intervals. Annual tree growth may be esitmated dependent upon correctly identifying unique individuals across scans in the presence of noise. We formalize a two-stage modeling framework, connecting the record linkage model and a flexible downstream individual tree growth model, that provides robust uncertainty quantification and propagation through both stages of the modeling pipeline through an extension of the "linkage-averaging" approach of \cite{sadinleBayesianPropagationRecord2018}. In this paper, we discuss the two-stage model formulation, outline the computational strategies required to achieve scalability, assess the model performance on simulated data, and fit the model to a bi-temporal dataset derived from LiDAR scans of the Upper Gunnison Watershed provided by the Rocky Mountain Biological Laboratory to assess the impact of key topographic covariates on the growth behavior of conifer species in the Southern Rocky Mountains (USA). 
keywords: Record Linkage, Entity Resolution, Bayesian Hierarchical Model, LiDAR, Tree Demography
---


\section{Introduction}\label{section1}

The characterization and quantification of forest dynamics has been an area of interest for ecologists throughout the twentieth century and has become an increasingly important metric for understanding the effects of climate change [\cite{hyyppaReviewMethodsSmallfootprint2008}]. Historical investigations of forest dynamics have relied on field surveys over limited spatial domains, which are generally time consuming and potentially difficult to perform [\cite{saatchiBenchmarkMapForest2011, wenselTreeHeightDiameter1987}]. The advent and ongoing refinement of aerial laser scanning (ALS) technology has ushered in a new age of data collection in terms of scalability. The use of ALS data in the modeling of forest dynamics has become a standard approach, as it enables researchers to examine the health and behavior of forests at larger scales than has previously been possible by field survey [\cite{babcockModelingForestBiomass2016, dalponteTreecentricMappingForest2016}]. The obvious extension of these efforts is to functions that rely on repeat measurements over time. Despite improvements in the accuracy of ALS technology, there remains inherent uncertainty in both the scanning mechanism and subsequent post-processing of the data as discussed by \cite{huoIndividualTreeDetection2020}. In the existing literature, the mechanisms employed for identifying the unique individuals from scans across multiple time points have been largely heuristic and rely upon manual verification, as in \cite{maQuantifyingIndividualTree2018}, and employ a two-stage modeling schema which fails to incorporate the uncertainty from the matching procedure into the downstream task. To address these issues, we present an alternative two-stage framework utilizing a record linkage approach for spatial location data that is capable of efficiently identifying unique individuals across larger spatial domains while providing robust uncertainty quantification for the linkage that may then be propagated into the downstream modeling objective.

As our ability to collect and store data has exploded, so too has our need to engage in record linkage and deduplication, which are commonly jointly referred to as entity resolution. At its core, the field of record linkage is concerned with the resolution of unique records across overlapping files in the absence of a unique identifier. In this paper we will use the term record linkage in a general sense to encompass the process of identifying coreferent records both between and within files. Historically, files have represented repeated surveys over time [\cite{steortsEntityResolutionEmpirically2015a}], or non-temporally linked overlapping databases such as patient records across different providers in the healthcare system [\cite{padmanabhanApproachRecordLinkage2019}]. The earliest approaches to probabilistic record linkage, as formalized by \cite{Fellegi1969}, performed probabilistic matching between pairs of records according to a decision theoretic framework. The field has developed consistently since its inception, and advances in Bayesian computational methods have given rise to a new class of probabilistic modeling approaches over the last 20 years as discussed by \cite{Liseo2011advances}. While methods that perform matching between pairs of records directly have remained useful [\cite{Sadinle2017}], models built upon latent matching structures have become increasingly popular alongside methods addressing alternative types of data [\cite{steorts2016bayesian, liseoBayesianEstimationPopulation2011}]. Recently, record linkage has been successfully used to improve wildlife population inference from a series of sequential aerial photographs [\cite{Lu2022}]. In a similar vein, we introduce a record linkage model for multi-temporal spatial location data derived from LiDAR (light detection and ranging) scans intended to improve tree demography inference.

While record linkage is an interesting and challenging endeavor on its own, it generally functions as the first step in the sequence of a statistical pipeline as discussed by \cite{kaplanPracticalApproachProper2022}. We implement our spatial record linkage model in a two-stage framework in which the record linkage and downstream task are performed sequentially. Our proposed approach performs the downstream modeling task using a randomly sampled subset of iterations from the posterior linkage structure, which propagates the uncertainty from the linkage into the second stage of the pipeline according to the "linkage-averaging" (LA) approach of \cite{sadinleBayesianPropagationRecord2018}. Crucially, in the LA framework, the linkage is not informed by the downstream task. Consequently, the output from the first stage record linkage model may be used as the input for a variety of downstream models, offering researchers a high degree of flexibility when adopting this modeling framework. We discuss the justification for the LA approach for a general downstream auxiliary data task followed by a demonstration of our two-stage modeling framework in the context of modeling population growth curves for conifer forests using bi-temporal ALS derived data. 

In our application, we pair the spatial record linkage model with an individual tree growth model, where we define the growth metric as the change in canopy volume between surveys on an annual scale. The empirical data is comprised of LiDAR scans of Gunnison National Forest from the years 2015 and 2019 provided by the Rocky Mountain Biological Laboratory (RMBL). The individual tree crown polygons and associated attributes were obtained from a 1/3 \unit{\meter} resolution canopy height model (CHM) using the `ITCsegment` algorithm in the `lidR` package in `R` as developed by \cite{dalponteTreecentricMappingForest2016}. We note that the record linkage and growth models are both designed to account for various sources of biological variation and measurement error in the data collection and post-processing procedures.

The remaining structure of the paper is as follows. In Section \ref{section2}, we highlight the ecological hypotheses and empirical data that motivate our novel modeling approach. In Section \ref{section3}, we introduce the relevant notation and structure for the spatial record linkage model and specific growth model that serves as our downstream modeling objective. Additionally, we outline the computational strategies we employ in implementing and fitting the model. In Section \ref{section4}, we provide a discussion of the theoretical justification for the linkage-averaging modeling approach in a general auxiliary data task setting. In Section \ref{section5}, we provide an analysis of the empirical data and in Section \ref{section6}, we examine the performance of the proposed modeling approach in a series of numerical experiments on simulated data. Finally, in Section \ref{section7} we discuss our conclusions and related future work.


\section{Empirical Data: LiDAR Derived Individual Tree Characteristics from Multi-temporal Scans of Snodgrass Mountain}\label{section2}

We apply our two-stage modeling approach to identify unique trees across time points and to estimate spatial patterns of tree growth as related to certain environmental drivers in a spruce-fir forest site located in the Southern Rocky Mountains (USA). The study site is a two square kilometer forested domain located on Snodgrass Mountain near the site of RMBL in the vicinity of Crested Butte, Colorado. The domain spans montane to lower subalpine mountain slopes at elevations from 2891-3395\unit{\meter} and experiences a cold continental climate with persistent seasonal snowpack accounting for the majority of annual precipitation [\cite{carroll_efficiency_2020}]. Evergreen forests in the domain are dominated by Engelmann spruce (*Picea engelmannii*) and subalpine fir (*Abies lasiocarpa*), which account for more than 80% of the tree canopy. These forests also contain scattered lodgepole pine (*Pinus contorta*) and Rocky Mountain Douglas-fir (*Pseudotsuga menziesii subsp. glauca*). Deciduous quaking aspen (*Populus tremuloides*) forms large single-species stands on lower slopes of the study area, but these areas were excluded from the analysis. The growth dynamics of quaking aspen are more difficult to assess due to the biological structure of the stands, so we focus our analysis on the mixed conifer stands that populate the majority of the study site.

Forest structural data was collected for the study area via aerial laser scanning (LiDAR) in two intervals during 2015 and 2019. Both scans were collected from an airplane-based sensor in late summer before the drop of deciduous leaves. The laser scanner records discrete peaks of reflected energy at near-infrared wavelengths and uses the integrated Real-time Kinematic (RTK) sensor position and estimated time-of-flight of laser pulses to locate laser reflections ("returns") in geographic space. The scanning process yields a dense (8-16 pts / \unit{\meter^2}) cloud of 3-dimensionally located returns representing reflections from the ground, tree canopies, and other reflective surfaces. Details of each LiDAR dataset used in the present analysis are provided in Table \ref{scanattributes}.

\begin{table*}
\caption{LiDAR data collection attributes for the 2015 and 2019 scans provided by RMBL.}
\label{scanattributes}
\begin{tabular}{@{}lll@{}}
\hline
Scan Attribute & 2015 Scan & 2019 Scan \\
\hline
Acquisition Dates &	August 7, 2015 and August 10, 2015 & August 21 – September 24, 2019\\
Aircraft Used &	Piper Navajo & Cessna Caravan \\
Sensor &	Reigl (Leica) Q1560 &	Riegl (Leica) VQ1560i \\
Maximum Returns / Pulse & 5 &	15 \\
Target Pulse Density & Average 8 pulses $\unit{\meter^2}$ & Average 2 pulses $\unit{\meter^2}$ \\
Realized Point Density &	 	9.4 pts / $\unit{\meter^2}$ & 9.4 pts / $\unit{\meter^2}$ \\
Survey Altitude (AGL) &	\qty[mode = text]{550}{\unit{\meter}} &	\qty[mode = text]{1159}{\unit{\meter}} \\
Field of View &	\ang[mode = text]{58} &	\ang[mode = text]{58.5}\\
\hline
\end{tabular}
\end{table*}


  The LiDAR-derived point clouds were segmented and summarized to yield estimates of per-tree structural characteristics including tree top locations, maximum heights, and canopy volumes using functions in the `R` package `lidR` [version 3.4, \cite{rousselLidRPackageAnalysis2020a}]. Although numerous approaches exist to segment individual trees in LiDAR data (see \cite{aubry-kientz_comparative_2019} for a recent comparison), for this analysis we adopted the commonly-used `ITCsegment` algorithm [\cite{dalponteTreecentricMappingForest2016}]. `ITCsegment` is a region-growing approach which iteratively incorporates points into candidate tree canopies starting at a set of seed locations. Seed locations (putative tree tops) were selected using a local maximum filter, identifying laser returns with high heights relative to a height-dependent local neighborhood. Canopy volumes were calculated by summing canopy heights for each segment using a \qty[mode = text]{1}{\unit{\meter}} resolution canopy surface model generated using the `pit-free` algorithm implemented in `lidR`. The segmentation and canopy surface model generation steps generate imperfect representations of individual tree locations and crown geometries. Errors in sensor geo-positioning and ranging measurements can lead to systematic spatial shifts in datasets collected at different times. Moreover, the location and trajectory of individual laser pulses differs between scans, leading to small amounts of variability in estimated maximum heights and crown locations as discussed by \cite{poorazimyFeasibilityBiTemporalAirborne2022}.

In Western North American conifer forests, tree growth is thought to be constrained by the (potentially interacting) availability of water and energy [\cite{buechling_climate_2017, heilman_ecological_2022}]. To investigate these constraints, we assembled estimates of key water and energy proxies across the domain from diverse remote sensing datasets. A \qty[mode = text]{1}{\unit{\meter}} resolution LiDAR-derived Digital Elevation Model [\cite{goulden_neon_2020}] was used to compute topographic aspect "folded" about the north-south axis to distinguish high solar-radiation south-facing slopes from low solar-radiation north-facing slopes. We also computed a topographic wetness index (TWI) [\cite{nobre_height_2011}] as a water availability proxy. We augmented these topographic proxies with gridded climate data interpolated from weather station and microclimate sensors as well as satellite-derived maps of the persistence of seasonal snowpack [\cite{breckheimer_integrated_2023}]. Data for snowpack persistence and growing degree days was aggregated annually from 2015 to 2019 and the median observed values were used during modeling to capture the relative impact of these covariates over the period between LiDAR scans. Details pertaining to the covariates may be found in Table \ref{covariateinfo} along with a visualization of the derived tree geometries and raster images in Figure \ref{emp_rast_plot}.


\begin{table*}
\caption{Designations and details for the topographic covariates included in the analysis.}
\label{covariateinfo}
\begin{tabular}{@{}llll@{}}
\hline
Growth Constraint & Covariate &	Data Source &	Resolution (\unit{\meter}) \\
\hline
Energy & Folded Aspect & \cite{goulden_neon_2020} & 1 \\
Energy & Growing Degree Days & \cite{breckheimer_integrated_2023} & 30 \\
Water & HAS Wetness Index & \cite{goulden_neon_2020, nobre_height_2011} & 1 \\
Water & Snowpack Persistence & \cite{breckheimer_integrated_2023} & 30 \\
\hline
\end{tabular}
\end{table*}

\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/emp_rast_plot.png"}
\caption{Plots (a) and (b) show the derived crown geometries from the 2015 and 2019 LiDAR scans performed by RMBL for the full datsets and a medium density inset (outlined in plot (a)). Plots (c)-(f) show the scaled raster images for the topographic covariates of interest over the study domain.}
\label{emp_rast_plot}
\end{figure}

\section{Models and Notation}\label{section3}

In this section we detail the spatial record linkage and growth models employed in our two-stage linkage-averaging approach. We first define the necessary notation and present the proposed spatial record linkage model before developing the downstream individual tree growth model. We finish this section with a discussion of the computational strategies employed to facilitate scalability of the record linkage model to spatial domain sizes that are of practical interest.

\subsection{Record Linkage Model}\label{section3.1}

We begin by presenting the spatial record linkage model as a standalone component to introduce the model structure and to establish a baseline for inclusion in modeling pipelines with alternative downstream tasks. We provide a general model capable of handling multiple files, which is also capable of performing deduplication within files. We employ a Bayesian hierarchical structure based on latent matching, as discussed by \cite{steorts2016bayesian} and \cite{liseoBayesianEstimationPopulation2011}, such that records are linked to unobserved latent entities with true field values instead of being probabilistically matched to other records directly through comparison vectors, as in the work of [\cite{Fellegi1969}] andd \cite{Sadinle2017}. In the spatial record linkage model, the value associated with the latent entity is the true unobserved location of the individual. We treat the observed data as a noisy observation of the latent and include provisions for different potential sources of noise. We consider error introduced as a function of translation and rotation in the data collection process, post-processing of the data, and due to biological mechanisms. We specify the data model and relevant notation as follows.

The model is constructed to handle multiple files, where the files are indexed from $i = 1, \dots, m$ with relative size $n_i$ for each file and such that $m \geq 2$. The records within files are indexed from $j = 1, \dots, n_i$ such that the total number of observed records is $n = \sum_{i=1}^m n_i$. We denote the observed location data for the $j^{th}$ record in file $i$ as $\bmy_{ij}$, where $\bmy_{ij}$ is a numerical vector of length 2, i.e. $\bmy_{ij}=\left(x,y \right)_{ij}$, corresponding to the spatial coordinates of the record in the $\left(x,y \right)$-plane. We note that in our application the term file is synonymous with a LiDAR scan and record with an individual identified tree such that $n$ is the total number of individual trees detected across all scans.

We define the latent location vector as $\bms_{j'}$, where $j'=1,\dots,N$ such that $N$ is the maximum number of unique latent individuals in the population under consideration. The observed locations $\bmy_{ij}$ are modeled as noisy versions of the latent locations $\bms_{j'}$. The record sets $\bmy_{2j}, \dots, \bmy_{mj}$ are modeled as transformed versions of the associated $\bms_{j'}$, where we restrict the possible transformations considered to rotation and translation.  

The linkage structure, which identifies the relationship between the observed records and the latents, is a vector of length $n$ denoted as $\bmLambda = \left\{\lambda_{ij}: i=1,\dots,m, \ j=1,\dots,n_i \right\}$, where $\lambda_{ij}$ is an integer indicating which latent entity the $j^{th}$ record in file $i$ refers to. The linkage is implicitly dependent on the maximum latent population size $N$, as $\lambda_{ij} \in \left\{1,\dots,N \right\}$. The specified linkage structure naturally defines a set of $N$ clusters denoted $\mathcal{C}(\bmLambda)$, which specify the records that are linked to each latent individual such that $\mathcal{C}\left(\bmLambda\right) = \left\{ \mathcal{C}_1,\dots,\mathcal{C}_N \right\}$. The individual clusters are defined as the sets $\mathcal{C}_{j'} = \left\{ (i,j): \lambda_{ij} = j' \right\}$ for $j' = 1,\dots,N$, and we note that the clusters may be empty or may contain records from the same file in addition to records across files highlighting the capacity of the model for performing record linkage and deduplication simultaneously.  

Previous record linkage modeling approaches are known to be sensitive to the specification of $N$, which functions as a hyperparameter in the model [\cite{steorts2016bayesian}]. We specify $N=q \times\max\left(n_i\right)$ where the scale factor $q$ is chosen to reflect the assumed degree of overlap between the files and such that $N \leq n$. Alternatively, a practitioner could specify $N=n$ to avoid making any a priori assumptions about the number of unique individuals across files. Although not explicitly a parameter in the model, we do effectively obtain an estimate of the number of unique individuals across files which is often of interest in studies investigating species abundance and provides some sense of the effective sample size for estimation of the downstream model parameters.   

The addition of the image alignment framework, as introduced by \cite{Green2006}, allows us to model the variation produced by the underlying biological process (assumed to be tree growth in this application) separately from the error introduced in the LiDAR scanning and post-processing procedures. The data model, which describes the relationships between the observed point patterns and latents, is given by
$$
\bmy_{ij} \mid \bms_{\lambda_{ij}}, \bmt, \bmtheta, D \sim \text{Normal}_2 \left(\bmR\left(\theta_i\right)\left(\bms_{\lambda_{ij}} - \bmmu_D\right) + \bmt_i + \bmmu_D, \sigma^2 \bmI \right),
$$
for $i = 2,\dots,m$. We note that the latents are assumed to exist in the same space as the records in the first file to reduce the effective number of parameters in the model such that
$$
\bmy_{1j} \mid \bms_{\lambda_{1j}}, \sigma^2, D \sim \text{Normal}_2 \left(\bms_{\lambda_{1j}}, \sigma^2 \bmI\right).
$$
The rotation, $\bmR(\theta_i)$, is the standard counterclockwise rotation matrix given by
$$
\bmR\left(\theta_i\right) = \bbmx \cos\left(\theta_i\right) & -\sin\left(\theta_i\right) \\ \sin\left(\theta_i\right) & \cos\left(\theta_i\right) \ebmx
$$
and $\bmt_i$ is the two dimensional translation vector. We allow the rotation angle and translation to vary across files (i.e. scans). The rotation for each file is around the midpoint, denoted $\bmmu_D$, of the spatial domain of interest $D$. We also note that $\bmy_{1j}$ can be expressed in terms of the rotation and translation framework with fixed $\theta_1 = 0$ and $\bmt_1 = \bbmx 0 & 0 \ebmx^\mT$, and we adopt this expression to simplify notation going forward. 

The spatial record linkage model is specified as follows
$$
\baln
\bmy_{ij} \mid \bms_{\lambda_{ij}}, \sigma^2, \theta_i, \bmt_i, D &\stackrel{ind}{\sim} \text{Normal}_2\left(\bmR\left(\theta_i\right)\left(\bms_{\lambda_{ij}} - \bmmu_D\right) + \bmt_i + \bmmu_D, \sigma^2 \bmI, D\right) \\
\bms_{j'} \mid N &\stackrel{iid}{\sim} \text{Uniform}\left(D^*\right) \\
\sigma^2 &\sim \text{Truncated Inverse Gamma}\left(c_\sigma, d_\sigma, 0, b_\sigma\right) \\
\lambda_{ij} \mid N &\stackrel{iid}{\sim} \text{Uniform}\left\{1,\dots,N\right\} \\
\theta_i &\propto \text{exp} \left(\kappa \cos\left(\nu\right) \cos\left(\theta_i\right) + \kappa \sin\left(\nu\right) \sin\left(\theta_i\right)\right) I\left\{\left|\theta_i\right| < b_\theta \right\} \\
\bmt_i &\sim \text{Normal}_2 \left(\bm0, \sigma_t^2 \bmI\right),
\ealn
$$
where the prior for $\theta_i$ is the kernel of a truncated von Mises distribution, as discussed by \cite{Green2006}.   

As mentioned above, we model the observed locations as noisy transformations of the unobserved true latent locations according to a Gaussian noise process. We specify the underlying latent point process, $\bms$, to follow a uniform distribution over a slightly expanded spatial domain $D^*$ to allow for the possibility that the true location of an individual is outside of the observed spatial domain. We assume the simplest and least informative specification for the latent point process, corresponding to a homogeneous Poisson process with a fixed size, which allows the observed locations to provide the bulk of the information in determining the distribution of the latents and to allow this distribution to vary adequately over space. In practice, users could specify more complicated latent process models, which may fit the observed data more precisely but with additional assumptions, computational cost, and complexity (see \cite{leiningerBayesianAnalysisSpatial2014} for an indepth discussion of point process models in a Bayesian hierarchical framework). We note that the priors for the latent spatial point process $\bms$ and the linkage structure $\bmLambda$ are dependent on the hyperparameter $N$, which quantifies our belief regarding the upper bound on the number of unique entities across all files. We provide additional discussions of the considerations for specifying the hyperpriors for the model in Appendix A of the Supplementary Materials.

Many latent record linkage modeling approaches employ a hit-miss mechanism for whether the observed records are a noisy distortion of the true latent value in a given field as in \cite{steorts2016bayesian}. In contrast, our model treats every observed record as a noisy copy of the latent as we are dealing with spatial locations over a continuous domain. In the context of our motivating application, the observed locations are the tree crowns while the latent location is the tree base. Thus, the assumption that every observed location is a noisy observation of the truth has a clear physical interpretation in this case as well. We place a conjugate truncated inverse gamma distribution prior on the measurement error parameter $\sigma^2$, where the upper bound corresponds to the maximum displacement that would be considered plausible based on the biological mechanisms of tree growth and the calibration of the LiDAR scanning equipment.


\subsection{Downstream Growth Model}\label{section3.2}

We now turn to a discussion of the individual tree growth model that we employ in this application. The model leverages the known allometric relationship between size and growth by using a flexible nonlinear function of the generalized Michaelis-Menten type to describe the population annual growth curve while allowing for measurement error in the observed growth (measured by the change in canopy volume). Michaelis-Menten functions have been applied broadly across biological and ecological growth models, as described by \cite{lopezGeneralizedMichaelisMentenEquation2000a} and \cite{bolkerEcologicalModelsData2008}. The generalized Michaelis-Menten function can take on a range of shapes from a logistic to a sigmoidal curve depending on the parameterization, where our specification may be seen in Equation 1 below. The relative simplicity and flexibility of the function class combined with the clear biological interpretations of the parameters make this model a compelling choice provided that the simplifying assumption of a maximum size is reasonable. Michaelis-Menten growth models have been found to be ideal for describing the relationship between diameter at breast height (DBH) and height for trees (\cite{Barbosa2019, Brahma2017}), which is analogous to the size-growth relationship between canopy volume and tree growth in our application. Although literature employing a Michaelis-Menten function in a measurement error model is scarce, the extension is natural and straight forward. 

Our specification of the growth function incorporates the topographically derived covariates, discussed in Section \ref{section2}, allowing us to better understand the impact that environmental drivers have on the growth behavior of conifer species. We introduce the relevant notation for the downstream growth model and clarify the relationship with the spatial record linkage model as follows.  

We previously defined the set of clusters $\mathcal{C}\left(\bmLambda\right)$ derived from the linkage structure of the spatial record linkage model, and we further restrict this set to the clusters for which growth is observed. We define the set of growth clusters $\mathcal{C}^G\left(\bmLambda\right)$, with respect to several ecological conditions, which correspond to the individual trees identified by the linkage model for which a plausible amount of growth has occurred. For notational clarity, we introduce the functions $\min^f\left(\right)$ and $\max^f\left(\right)$ which return the minimum and maximum file index, respectively, for a given cluster. We note the implicit ordering in the file indices relative to time, such that the first file is the oldest and the last file is the most recent. We denote the observed canopy volume of the $j^{th}$ record in file $i$ as $v_{ij}$, measured in cubic meters, where the file index is synonymous with the data collection time point associated with the file. The set of growth clusters may be defined accordingly as $\mathcal{C}^G\left(\bmLambda\right) = \{ \mathcal{C}_{j'}: \max^f\left(\mathcal{C}_{j'}\right) \neq \min^f\left(\mathcal{C}_{j'}\right) \  \& \ r_1\cdot v^*_{\min^f\left(\mathcal{C}_{j'}\right)} < v^*_{\max^f\left(\mathcal{C}_{j'}\right)} < r_2\cdot v^*_{\min^f\left(\mathcal{C}_{j'}\right)} \}$ such that $\mathcal{C}^G\left(\bmLambda\right) \subseteq \mathcal{C}\left(\bmLambda\right)$. Where $v^*_{\min^f\left(\mathcal{C}_{j'}\right)}$ and $v^*_{\max^f\left(\mathcal{C}_{j'}\right)}$ denote the summed volumes of the records associated with the minimum and maximum file indices in the cluster. This implicitly defines a procedure that merges the volumes of linked records within files as a result of deduplication from the linkage model. The hyperparameters $r_1$ and $r_2$ control the lower and upper bounds for the change in canopy volume for a growth cluster relative to the typical and biologically feasible growth behavior for the time interval between the observed records. We exclude the clusters which do not satisfy these growth rate constraints from the set of growth clusters used to estimate the growth model parameters.

The row vector $\bmx_{s_c}$, of length $p + 1$, contains the $p$ observed covariates at the latent location $\bms_c$ for the growth cluster $\mathcal{C}^G_c$ with first element corresponding to the baseline growth rate asymptote. We note that the topographic covariates (Folded Aspect, Growing Degree Days, HAS Wetness Index, and Snowpack Persistence in this application) are assumed to be centered and scaled across the entire surface of the domain of interest $D$ prior to inclusion in the model.

For each growth cluster $\mathcal{C}^G_c \in \mathcal{C}^G\left(\bmLambda\right)$, $g_{c}$ is the observed annual growth for cluster $c$ and is defined as a function of the first and last cumulative volume measurements for the linked record set $\mathcal{C}^G_c$ such that
$$
g_{c} = \frac{v^*_{\max^f\left(c\right)} - v^*_{\min^f\left(c\right)}}{t \left( \max^f \left(c\right)\right) - t\left( \min^f \left(c \right) \right)}.
$$
The function $t()$ returns the year associated with the file index so that the difference in observed canopy volumes is scaled by the length of the interval between measurements to place the observed growth on an annual scale. We model the observed annual growth as a function of the true growth, which we specify as a Michaelis-Menten type function dependent upon the initial observed canopy volume and the environmental covariates associated with the record's latent location, while allowing for measurement error, such that
\begin{equation}
g_{c} \sim \text{Skewed t} \left( \mu_c, \tau, \delta, \omega \right), \text{ for } \mu_c = \frac{\left(\bmx_{s_c} \bmbeta\right) {v^*_{\min^f\left(c\right)}}^\alpha}{\gamma^\alpha + {v^*_{\min^f\left(c\right)}}^\alpha}.
\end{equation}
As mentioned above, a notable advantage of the generalized Michaelis-Menten style growth function is that the parameters of the true growth function have clear biological interpretations. The linear component of the function adjusts the maximum growth asymptote as a function of the covariates at a given location. The parameter $\gamma$ controls the size at which the growth rate due to size scaling saturates, effectively establishing the inflection point of the growth curve. The parameter $\alpha$ controls the curvature of the growth function, where values of $\alpha > 1$ result in a sigmoidal curve and values of $\alpha \leq 1$ result in a shape more akin to a logistic curve. While the true growth is generally assumed to be non-negative, our model allows for the observed growth to be negative as a function of measurement error.  

The growth model is defined as follows
$$
\baln
g_c \mid \gamma, \bmbeta, \tau^2, \bmLambda, \bmx_{\bms_c}, \bmv^* &\sim \text{Skewed t} \left( \mu_c, \tau, \delta, \omega \right) \\
\tau &\sim \text{Uniform} \left(0, b_\tau \right) \\
\delta &\sim \text{Truncated Normal} \left( 0, \sigma^2_\delta, -1, 1 \right) \\
\omega &\sim \text{Gamma} \left(2, b_\omega \right) \\
\gamma &\sim \text{Uniform}\left(a_\gamma, b_\gamma \right) \\
\alpha &\sim \text{Beta}\left(a_\alpha, b_\alpha, c_\alpha, d_\alpha \right) \\
\beta_0 &\sim \text{Normal} \left(\mu_0, \sigma^2_0 \right) \\
\beta_k &\sim \text{Normal} \left(\mu_{\beta_k}, \sigma_{\beta_k}^2 \right),
\ealn
$$
for $k = 1, \dots, p$, and where the specification of the hyperparameters is informed by the advice of domain science experts, while being adequately diffuse where appropriate. We model the observed growth, annual change in canopy volume, as a nonlinear function of the initial size and a set of environmental covariates at the latent location of the individual with skewed measurement error derived from the LiDAR processing algorithm described in Section \ref{section2}. We place a weak Uniform prior on $\gamma$ with the lower and upper bounds specified as the minimum reasonable growth saturation value as a function of size and the maximum size observed in the first file, as the parameter corresponds to the size at which the growth rate reaches its half maximum. We specify a four parameter Beta prior for the shape parameter $\alpha$ where the upper bound limits the degree of possible curvature in the growth function. A non-informative version of this prior takes $a_\alpha = b_\alpha = 1$ corresponding to a Uniform distribution over the specified range. We assume the individual $\beta_k$ coefficients are independent a priori and assign appropriately diffuse Normal priors with the understanding that all covariates have been centered and scaled prior to inclusion in the model. We place a weak Gamma prior on $\omega$, where $\omega$ controls the kurtosis of the distribution. Finally, we specify a truncated normal prior for the skewness parameter $\delta$, where the truncation bounds follow the support of the parameter. In this model formulation we adopt a nonlinear regression Skewed t error model, as presented by \cite{delacruzBayesianAnalysisNonlinear2009}, to account for the observed structure of our empirical data. For our specific Skewed t density, we follow the formulation of \cite{theodossiouFinancialDataSkewed1998} and make the appropriate location and scale adjustments such that $\mu_c$ and $\tau$ are the mean and variance of the distribution respectively. We do note however, that this modeling framework may be applied more generally with alternative assumed error processes dependent upon the requirements of a given application. For example, we consider a normal error process in the simulation study that we present in Section \ref{section6}.


Combining the spatial record linkage and downstream growth models, as seen in the plate diagram in Figure \ref{plate_diag}, we obtain the structure for the two-stage modeling approach. Following the linkage-averaging procedure outlined by \cite{sadinleBayesianPropagationRecord2018}, we propose using a random sample of iterations from the marginal posterior of the linkage structure $\bmLambda$ and the latent spatial point process $\bms$, obtained from the linkage stage, as inputs for the downstream model. The LA approach effectively marginalizes out the uncertainty from the linkage and the latent locations and provides equivalent inference for the growth model parameters compared to the marginal inference that would be obtained from a joint model under certain conditions. We discuss the requirements and justification for this approach in greater depth in Section \ref{section4}.

\begin{figure}
  \centering
    \begin{tikzpicture}[x=1cm,y=1cm,
                        roundnode/.style={circle, draw=black, fill=white, thick, minimum size=.75cm},
                        lroundnode/.style={circle, draw=black, fill=black!10, thick, minimum size=.75cm},
                        squarednode/.style={rectangle, draw=black, fill=white, thick, minimum size=.75cm}]
      % Nodes
      \node[squarednode, scale = 1] (yij) {$\boldsymbol{y}_{ij}$} ; %
      \node[lroundnode, below = of yij, scale = 1] (lambdaij) {$\lambda_{ij}$} ; %
      \node[roundnode, left = of yij, scale = 1] (ti) {$\boldsymbol{t}_{i}$} ; %    \
      \node[squarednode, left = of ti, scale = 1] (sigma2t) {$\sigma^2_{t}$} ; %    \
      \node[roundnode, below = of ti, scale = 1] (thetai) {$\boldsymbol{\theta}_{i}$} ; %    \
      \node[squarednode, left = of thetai, scale = 1] (kappa) {$\kappa$} ; %
      \node[squarednode, below = of kappa, scale = 1, yshift = .5cm] (nu) {$\nu$} ; %
      \node[roundnode, above = of yij, scale = 1] (sigma2) {$\sigma^2$} ; %
      \node[squarednode, left = of sigma2, scale = 1] (D) {$D$} ; %
      \node[squarednode, above = of sigma2, scale = 1] (dsigma) {$d_{\sigma}$} ; %
      \node[squarednode, left = of dsigma, scale = 1, xshift = .5cm] (csigma) {$c_{\sigma}$} ; %
      \node[squarednode, below = of lambdaij, scale = 1] (N) {$N$} ; %
      \node[squarednode, right = of yij, scale = 1, xshift = .5cm] (Xc) {$\boldsymbol{X}_{c}$} ; %
      \node[lroundnode, below = of Xc, scale = 1] (sj) {$\boldsymbol{s}_{j'}$} ; %
      \node[squarednode, below = of sj, scale = 1] (Dstar) {$D^*$} ; %
      \node[roundnode, right = of Xc, scale = 1] (gc) {$g_{c}$} ; %
      \node[roundnode, above = of gc, scale = 1] (gamma) {$\gamma$} ; %
      \node[roundnode, left = of gamma, scale = 1] (beta) {$\boldsymbol{\beta}$} ; %
      \node[roundnode, right = of gamma, scale = 1] (alpha) {$\alpha$} ; %
      \node[roundnode, right = of sj, scale = 1] (tau2) {$\tau$} ; %
      \node[squarednode, below = of tau2, scale = 1] (dtau) {$a_{\tau}$} ; %
      \node[squarednode, right = of dtau, scale = 1, xshift = -.5cm] (ctau) {$b_{\tau}$} ; %
      \node[squarednode, above  = of beta, scale = 1] (sigmabeta) {$\boldsymbol{\Sigma}_{\boldsymbol{\beta}}$} ; %
      \node[squarednode, left = of sigmabeta, scale = 1, xshift = .5cm] (mubeta) {$\boldsymbol{\mu}_{\boldsymbol{\beta}}$} ; %
      \node[squarednode, above = of gamma, scale = 1, xshift = -.5cm] (agamma) {$a_{\gamma}$} ; %
      \node[squarednode, above = of gamma, scale = 1, xshift = .5cm] (bgamma) {$b_{\gamma}$} ; %
      \node[squarednode, above = of alpha, scale = 1] (aalpha) {$a_{\alpha}$} ; %
      \node[squarednode, right = of aalpha, scale = 1, xshift = -.5cm] (balpha) {$b_{\alpha}$} ; %
      \node[squarednode, right = of alpha, scale = 1, yshift = .5cm] (calpha) {$c_{\alpha}$} ; %
       \node[squarednode, right = of alpha, scale = 1, yshift = -.5cm] (dalpha) {$d_{\alpha}$} ; %
      \node[roundnode, right = of gc, scale = 1] (delta) {$\delta$} ; %
      \node[roundnode, below = of delta, scale = 1] (omega) {$\omega$} ; %
      \node[ below = of thetai , xshift = -.55cm, yshift = .85cm]  (i) { $i$ };
      \node[ below = of lambdaij , xshift = -.55cm, yshift = 1cm]  (j) { $j$ };
      \node[ below = of sj , xshift = -.5cm, yshift = 1.05cm]  (jprime) { $j'$ };
      \node[ below = of Xc , xshift = -.5cm, yshift = .9cm]  (c) { $c$ };
      \node[squarednode, right = of delta, scale = 1] (sigma2_delta) {$\sigma^2_{\delta}$} ; %
      \node[squarednode, right = of omega, scale = 1] (b_omega) {$b_{\omega}$} ; %

      \edge {kappa} {thetai} ;
      \edge {nu} {thetai} ;
      \edge {sigma2t} {ti} ;
      \edge {ti} {yij} ;
      \edge {lambdaij} {yij} ;
      \edge {sigma2} {yij} ;
      \edge {D} {yij} ;
      \edge {thetai} {yij} ;
      \edge {sj} {yij} ;
      \edge {csigma} {sigma2} ;
      \edge {dsigma} {sigma2} ;
      \edge {N} {sj} ;
      \edge {Dstar} {sj} ;
      \edge {N} {lambdaij} ;
      \draw[dashed,->] (sj) -- (Xc);
      \edge {Xc} {gc} ;
      \draw[dashed,->] (lambdaij) -- (gc);
      \edge {tau2} {gc} ;
      \edge {alpha} {gc} ;
      \edge {gamma} {gc} ;
      \edge {beta} {gc} ;
      \edge {sigmabeta} {beta} ;
      \edge {mubeta} {beta} ;
      \edge {bgamma} {gamma} ;
      \edge {agamma} {gamma} ;
      \edge {aalpha} {alpha} ;
      \edge {balpha} {alpha} ;
      \edge {calpha} {alpha} ;
      \edge {dalpha} {alpha} ;
      \edge {dtau} {tau2} ;
      \edge {ctau} {tau2} ;
      \edge {delta} {gc} ;
      \edge {omega} {gc} ;
      \edge {b_omega} {omega} ;
      \edge {sigma2_delta} {delta} ;


       \plate[inner sep=.25cm, color=black] {j} { (yij) (lambdaij) } {  };
    \plate[inner sep=.3cm, color=black] {i} { (yij) (lambdaij) (ti) (thetai) } {  };
    \plate[inner sep=.25cm, color=black] {jprime} { (sj) } {  };
    \plate[inner sep=.25cm, color=black] {C} { (Xc)  (gc) } {  };


\end{tikzpicture}
\caption{Plate diagram for the two-stage record linkage and downstream growth model. Where $i=1,\dots,m$ denotes the file index, $j = 1,\dots,n_i$ denotes the record index within file $i$, $j' = 1,\dots,N$ denotes the latent index, and $c = 1, \dots, \lvert \mathcal{C}^G\left(\boldsymbol{\Lambda}\right) \rvert$ denotes the growth cluster index. The round nodes indicate parameters, while square nodes indicate hyperparameters. We note that solid arrows denote stochastic relationships, while dashed arrows identify the inputs from the record linkage model to the downstream growth model. This framework provides the structure for the linkage-averaging approach discussed in detail in Section \ref{section4}.}
\label{plate_diag}
\end{figure}


\subsection{Computational Strategies}\label{section3.3}

The two-stage Bayesian hierarchical model framework that we propose has many strengths including interpretability, the ability to incorporate relevant prior knowledge, and robust uncertainty quantification across the entire modeling pipeline. However, Bayesian entity resolution modeling approaches are known to carry additional computational overhead that can be prohibitive to the use of these models in practice when dealing with large datasets (see \cite{steortsComparisonBlockingMethods2014} and \cite{marchantDblinkDistributedEndtoEnd2021} for more complete discussions of blocking methods and limitations). We alleviate some of the computational expense associated with the use of a Markov chain Monte Carlo Gibbs sampling algorithm for our model through a few key mechanisms discussed below. 

One of the most common approaches for improving the scalability of record linkage models is to exact some form of deterministic blocking for records to reduce the number of comparisons necessary. This mechanism is commonly employed across both Bayesian and frequentist record linkage implementations as a preprocessing step that invalidates certain linkages that are deemed to be implausible [\cite{marchantDblinkDistributedEndtoEnd2021}]. While certain deterministic blocking schemes may impact the accuracy of the linkage and fail to adequately quantify the uncertainty associated with the procedure, we are able to take advantage of the spatial structure of our data and the biological limitations that invalidate certain links between observed records and latents as a function of euclidean distance. As an alternative to blocking, we implement a sampling scheme for $\bmLambda$ in our Gibbs sampling algorithm that allows us to approximate the posterior linkage structure under the assumption that the observed location for an individual must be within a maximum distance of the true latent location that it is associated with. In contrast to blocking schemes which invalidate links as a function of comparisons between records, our approach limits the linkage structure directly. Absent the use of a blocking or approximation scheme, the time required to sample from the true posterior distribution of the linkage structure $\bmLambda$ increases quadratically with the number of records. Instead of considering the full set of possible latents for each record when sampling the latent matching structure, we consider only latents within a bounding box around the observed record. Additionally, we impose the restriction that there must be at least two candidate latents within the bounding box otherwise we increase the size of the box iteratively until this condition is met to ensure a reasonable approximation of the cluster assignment probabilities. We note that the spatial bounding approach yields samples from an approximate posterior distribution, however the latents removed from consideration have near zero probability associated with them as possible matches and their removal allows us to maintain a consistent computational cost in the sampling of each individual $\lambda_{ij}$. In Figure \ref{psm_cor}, we consider the correlation between posterior similarity scores, which measure how often records are estimated to be coreferent, for bounding boxes of varying sizes. This figure demonstrates the accuracy of the spatial bounding box approach for approximating the true posterior distribution of the linkage structure for moderately dense subsets of the empirical data.
\begin{figure}
\centering
\includegraphics[scale = .6]{"../plots/F23/cor_plot_200.png"}
\caption{Correlation heatmap for the posterior similarity cluster scores for varying bounding box margins for an area of size \qty[mode = text]{200}{\unit{\meter^2}}.}
\label{psm_cor}
\end{figure}
Functionally, this scheme improves both the speed and efficiency of the record linkage model, as seen in Figure \ref{timing_plot}, and allows the model to scale to much larger domains of interest, which is a clear limitation of alternative modeling approaches. As the size of the bounding box increases we observe a near exponential increase in the average time required per iteration of the sampler run on a dense \qty[mode = text]{300}{\unit{\meter^2}} subset of our empirical dataset. Over this domain, we observe a 97.3 times speedup per iteration on average when using a bounding box of \qty[mode = text]{3}{\unit{\meter}} with the resulting linkage having a posterior similarity score correlation of .9984 compared to not using a bounding box. However, we note that the speed improvement for decreasing bounding box sizes is not universal as at some point we are required to expand the size of the box iteratively to meet the conditions established for guaranteeing a reasonable approximation of the cluster assignment probabilities.
\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/emp_timing_plot_all.png"}
\caption{Record linkage model Gibbs sampler timing results per iteration for varying bounding box margins around each sampled point. We consider the timing for areas of size \qty[mode = text]{100}{\unit{\meter^2}}, \qty[mode = text]{150}{\unit{\meter^2}}, \qty[mode = text]{200}{\unit{\meter^2}}, and \qty[mode = text]{300}{\unit{\meter^2}}. Plot a) shows the full timing results, while plot b) shows an inset for smaller bounding box margins.}
\label{timing_plot}
\end{figure}


To optimize the raw computation speed, the MCMC sampler is written in R and C++ using `Rcpp` [\cite{eddelbuettelRcppSeamlessIntegration2023}] and `RcppArmadillo` [\cite{eddelbuettelRcppArmadilloRcppIntegration2023}] to improve scalability over a base R implementation. We implement the downstream growth model in `rstan` to take advantage of the speed and flexibility of the NUTS algorithm [\cite{standevelopmentteamRStanInterfaceStan2023}]. Additionally, the optimized parallel computation available in `rstan` reduces the time required to fit the downstream growth model with minimal additional architecture required. The details of our Gibbs sampling algorithm for the spatial record linkage model may be found in the Supplementary Materials in Appendix A.


\section{Linkage-Averaging for Parameters from Auxiliary Data Models}\label{section4}

We present a discussion of the theoretical justification for the linkage-averaging approach, introduced by \cite{sadinleBayesianPropagationRecord2018} for population size estimation, for a general downstream task with auxiliary data, i.e. regression, when paired with a record linkage model that models the observed records as noisy versions of a set of true latent field values as in \cite{steorts2016bayesian} and \cite{liseoBayesianEstimationPopulation2011} and as defined in Section \ref{section3.1}. We demonstrate that under the following two mild conditions, this linkage-averaging approach may be reframed to provide proper Bayesian inference for the parameters of a more general downstream task. 

\begin{condition}\label{c1}
Our beliefs regarding the linkage structure $\bmLambda$ and the true latent field values $\bms$ are quantified by the joint posterior distribution $p_\text{LRL} \left(\bmLambda, \bms \mid \bmy \right)$, arising from a record linkage model employing a latent matching structure, where the posterior is proportional to the product of the likelihood $\mathcal{L}_\text{LRL}\left(\bmLambda, \bms \mid \bmy \right)$ and the joint prior $p\left(\bmLambda, \bms\right)$.
\end{condition}

We note that this condition depends on the use of a record linkage model that employs a latent matching structure in which the fields are modeled directly, though it would be straight forward to adapt for an alternative linkage model construction.

\begin{condition}\label{c2}
If the true linkage structure $\bmLambda$ and latent field values $\bms$ were known, the posterior $p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(\bms\right)\right)$ arising from an auxiliary data model with likelihood $\mathcal{L}_\text{AD}\left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(\bms\right)\right)$ and joint prior $p\left(\bmTheta\right)$, which may be further decomposed depending on the structure of the model, would encapsulate our beliefs regarding the downstream model parameters.
\end{condition}

The second condition describes the inferential process for $\bmTheta$, the vector of parameters from the auxiliary data model, under the assumption that the true linkage structure and latent field values are known. The combination of these two conditions provide the basis for our underlying argument, such that if these conditions hold, the following relationship
\begin{equation}
  p_{\text{LA}} \left(\bmTheta\right) = \E_{\bmLambda,\bms \mid \bmy} \left[ p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(\bms\right)\right) \right] = \sum_{\bmLambda} \sum_{\bms} p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(\bms\right)\right) \mathcal{L}_\text{LRL}\left(\bmLambda, \bms \mid \bmy\right), \nonumber
\end{equation}
is obvious to consider given its clear interpretation. We also demonstrate that $p_{\text{LA}} \left(\bmTheta\right)$ is a proper posterior distribution. In order to perform inference on $\bmTheta$ and $\left(\bmLambda, \bms\right)$ given $\bmy$, we require a joint prior for $\left(\bmTheta, \bmLambda, \bms\right)$ such that
\begin{equation}
  p\left(\bmTheta, \bmLambda, \bms\right) = p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(\bms\right)\right)  p\left(\bmLambda\right) p\left(\bms\right), \nonumber
\end{equation}
which follows naturally from Conditions \ref{c1} and \ref{c2} above.

\begin{theorem}[Bayesian validity of linkage-averaged auxiliary data model parameters joint posterior]\label{thm1}
  The marginal posterior of $\bmTheta$ under the likelihood $\mathcal{L}_\text{LRL}\left(\bmLambda, \bms \mid \bmy\right)$ of the latent entity resolution model and joint prior $p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right), \bmX\left(s\right)\right) p\left(\bmLambda\right) p\left(\bms\right)$ is $p_{\text{LA}}\left(\bmTheta\right)$.
\end{theorem}
Theorem \ref{thm1} establishes $p_{\text{LA}}\left(\bmTheta\right)$ as a valid posterior distribution. We provide the proof for \ref{thm1} in Appendix B of the Supplementary Materials, as the details are similar to the proof of \cite{sadinleBayesianPropagationRecord2018}. We note that the proof of \cite{sadinleBayesianPropagationRecord2018} holds specifically for population size estimation, in comparison to the result for a general downstream task with auxiliary data which we have established. In practice, we approximate the linkage-averaged posterior of $\bmTheta$, $p_{\text{LA}}\left(\bmTheta\right)$, with a random sample $\bmTheta^{\left(1,t\right)}, \dots, \bmTheta^{\left(l,t\right)} \sim p_\text{AD} \left(\bmTheta \mid \mathcal{C}\left(\bmLambda\right)^{\left(t\right)}, \bmX\left(\bms\right)^{\left(t\right)}\right)$, for each $t = 1,\dots,k$, such that
\begin{equation}
p_{\text{LA}}\left(\bmTheta\right) \approx \frac{1}{kl} \sum_{t = 1}^{k} \sum_{u = 1}^{l} I\left(\bmTheta = \bmTheta^{\left(u, t\right)}\right),
\end{equation}

where $k$ and $l$ are chosen to be sufficiently large to provide a reasonable approximation to the true posterior.  

The spatial record linkage and downstream growth models detailed in Sections \ref{section3.1} and \ref{section3.2} respectively, clearly satisfy the construction discussed above with $\bmTheta = \left(\alpha, \gamma, \bmbeta, \tau, \delta, \omega \right)$ and where $\bmX\left(\bms\right)$ represents the auxiliary data component of the model. We note that an alternative to the LA approach is to model the entity resolution and downstream task jointly, which allows the downstream task to inform the file linkage procedure. For example, \cite{gutmanBayesianProcedureFile2013} discuss a joint modeling approach based on multiple imputation that iteratively samples the unknown linking partition and the downstream model parameters. In their framework, the unknown links are treated as missing data and imputed. While the joint modeling approach may potentially improve the linkage, it is often accompanied by a substantially increased computational burden and the performance is sensitive to model misspecification for the downstream model. In contrast, the LA framework that we present provides equivalent marginal inference for the downstream model parameters as that obtained from a joint model and allows more flexibility for the researcher to recycle the linkage for multiple downstream tasks of interest that may be implemented in parallel in a straight forward and efficient fashion.  


\section{Estimation of Annual Growth Curves for Rocky Mountain Conifer Forests}\label{section5}

In this section, we return to the empirical data and related hypotheses regarding the annual growth behavior of Southern Rocky Mountain conifer forests presented in Section \ref{section2}. We employ the two-stage linkage-averaging approach for estimating the downstream growth model parameters using $k = 100$ randomly sampled iterations from the joint posterior distribution of the linkage structure $\bmLambda$ and latent locations $\bms$ as the input for the growth model. For each pair $\left( \bmLambda^{(k)}, \bms^{(k)} \right)$, we derive the set of growth clusters, $\mathcal{C}^G\left(\bmLambda^{(k)}\right)$, and the set of location dependent covariates, $\bmX \left(\bms_{\mathcal{C}^G\left(\bmLambda^{(k)}\right)}^{(k)} \right)$, which are then used to fit the growth model defined in Section \ref{section3.2}. This procedure allows us to obtain estimates of the marginal posterior distributions of the growth model parameters of interest that are equivalent to the marginals obtained from a joint model for the linkage structure, latent locations, and the growth model parameters, as discussed in Section \ref{section4}. For this analysis, we specify $r_1 = .9$ and $r_2 = 1.6$ such that we consider primarily positive growth with a maximum increase of 60% of the initial observed canopy volume over the 4 year study period. These cutoffs reflect typical growth behavior and disqualify implausible clusters arising from errors in the linkage and due to environmental mechanisms like damage from extreme wind or lightning that do not reflect the biological mechanisms of tree growth. 

In addition to the topographic covariates discussed in Section \ref{section2}, we also include three inter-tree competition metrics. \cite{fagerbergIndividualtreeDistancedependentGrowth2022} highlight the importance of including competition indices in individual tree growth models for conifer species. For our application, we consider relative spacing index (RSI), the ratio of the nearest neighbor distance to the average neighbor distance, larger neighbor volume (LNV), the summed canopy volumes of a tree's larger neighbors, and neighborhood density (ND), the density of individuals within the neighborhood of the individual. All competition metrics are calculated using the observed locations from the first scan (2015) within a \qty[mode = text]{15}{\unit{\meter}} neighborhood around each point such that all three are considered semi-distance dependent competition indices. To ensure that these metrics are accurate for all points considered, the downstream growth model is only fit to growth clusters located more than \qty[mode = text]{15}{\unit{\meter}} from the boundary of the study domain. We note that RSI and ND are measures of symmetric competition while LNV captures asymmetric competition among individuals to account for the variation possible across the range of competitive effects. An in depth discussion of competition indices and their construction may be found in \cite{pommereningTammReviewTree2018}. 

Given the size of the study domain (~\qty[mode = text]{2}{\unit{\km\squared}}), we fix the rotation parameter for the second scan, $\theta_2$, to be zero as even a very small degree of rotation can have a large effect on points near the boundary of the domain. We still allow for the possibility of scan-wide translation in this analysis, and we note that the choices of which image alignment components to include and the strength of their constituent priors will likely depend on the application. We select noninformative and weak priors, where appropriate, for the record linkage and downstream growth model parameters according to the outline in Section \ref{section3}. We specify $q=1.25$ in determining the maximum number of unique latent individuals $N$ to provide flexibility across the range of point densities observed in the study area. The convergence of the record linkage model and downstream model variants were assessed by examining traceplots and Gelman Rubin statistics [\cite{gelmanInferenceIterativeSimulation1992}] for each approach.The full model specification details and select convergence diagnostics may be found in Appendix C of the Supplementary Materials. 

In concert with the two-stage linkage-averaging approach, we consider two alternative heuristic strategies for linking trees across scans which we term nearest distance matching (NDM) and polygon overlap matching (POM). The NDM algorithm matches each tree crown location from the first scan with the closest point from the second scan. The POM approach uses the derived crown geometries from the LiDAR scans and traces the crown polygons from the 2015 scan forward and considers the overlap with the polygons from the 2019 scan and the change in canopy volume is calculated as the difference between the estimated volumes. While these methods do not perform deduplication and fail to provide uncertainty quantification for the linkage, they represent simple and easy to implement strategies for identifying unique individuals across scans and obtaining growth estimates that are analogous to methods being used in practice. For example, \cite{maQuantifyingIndividualTree2018} use a more sophisticated heuristic matching algorithm coupled with manual review of marginal matches. We apply the same growth cluster restrictions for these methods as for the LA approach, so the set of derived growths is characteristically equivalent across the three linkage procedures. During model fitting, we considered 4 candidate growth models, 3 with the non-linear Michaelis-Menten mean function, for each linkage strategy (Skewed t, Skew Normal, Normal, and Multiple Linear Regression with Normal Errors) and evaluated the model fit using the Continuous Ranked Probability Score (CRPS) as suggested by \cite{delacruzBayesianAnalysisNonlinear2009} following the discussion of \cite{gneitingStrictlyProperScoring2007}. We used the scaled CRPS (sCRPS) presented by \cite{bolinLocalScaleInvariance2022} which has been shown to be locally scale invariant and an improvement over the standard CRPS for model selection. The Skewed t model discussed in Section \ref{section3} was identified by the sCRPS metric as the top performing model for all 3 of the linkage schemes (additional details may be found in Appendix C of the Supplementary Materials). Figure \ref{coverage_plot} displays the 90% credible intervals for the covariate coefficients obtained from the three linkage approaches for the Skewed t model.

\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/coverage_comp_plot_covars2.png"}
\caption{Comparison of the 90\% credible intervals for the growth asymptote and the topographic and competition metric covariate coefficients obtained from the downstream model fit using data derived from the three different linkage approaches (LA, NDM, and POM).}
\label{coverage_plot}
\end{figure}

We see from the coverage plot that the POM approach results in drastically different estimates for the coefficients in terms of magnitude, and in some instances sign, coupled with high degrees of certainty in the estimates. In contrast, the NDM and LA approaches produce more similar estimates for the coefficients given that they are both distance based linkage approaches, although the NDM is deterministic and so does not marginalize out the uncertainty from the linkage procedure when fitting the downstream task like the LA approach. We also note that the estimates for the growth asymptote $\beta_0$ are notably different across the three linkage approaches, even for models with similar estimates of the covariate coefficients. In Figure \ref{growth_curve_plot}, we provide a comparison of the estimated size dependent growth curves arising from the LA model under high and low growth scenarios as a function of the topographic covariates Snowpack Persistence and Growing Degree Days, which are measures of water and energy availability, respectively, as discussed in Section \ref{section2}. We consider the 20th and 80th quantiles of the empirical distribution for these covariates while holding all other covariates at their median values to highlight the marginal effects on growth for these individual covariates with 90% credible bands. 

Our analysis suggests the importance of including topographic factors related to growth conditions in addition to competition indices in modeling size dependent individual tree growth over large spatial domains. While the growth behavior is primarily constrained by size, it is clear that these additional metrics are influential in determining the growth behavior of forests across varied terrains and localized densities. We observe that the interaction of topographic proxies for energy and water availability may have an impact on growth when accounting for some collection of symmetric and asymmetric competition metrics. We also note that the inference for the downstream model is sensitive to the choice of linkage approach, particularly when considering the estimated growth asymptote.

\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/growth_curve_comp_plot.png"}
\caption{Comparison of the estimated growth curves for varying quantiles of covariates of interest where plot a is the growth curve for Snowpack Persistance and plot b is the growth curve for Growing Degree Days. The plots demonstrate the change in growth behavior for low and high quantiles of the covariates while holding all other covariates at their median values.}
\label{growth_curve_plot}
\end{figure}

\section{Simulation Results}\label{section6}

In Section \ref{section6.1}, we introduce the data generation algorithm for producing biologically realistic simulated data sets. Subsequently, in Section \ref{section6.2}, we assess the performance of the linkage-averaging model as applied to a collection of simulated datasets under various scenarios modeled after the empirical data discussed in Section \ref{section2}. 

\subsection{Data Simulation}\label{section6.1}

Historically, ecological surveys of forest growth dynamics have relied extensively on field measurement data for validating models using ALS data, as in \cite{maQuantifyingIndividualTree2018}. These field surveys are often time consuming and expensive to perform, and provide a limited characterization of the model performance across a wide range of scenarios. Due to the scale and complexity of the study area we are considering, a validation dataset is unavailable. Instead, we gauge the efficacy of our model by considering the performance on simulated data across a variety of possible conditions as motivated by our empirical data. The majority of the existing simulation frameworks for marked point processes assume independence between the spatial point process and the mark distribution as noted by \cite{yongtaoTestIndependenceMarks2007}, however our application necessitates location dependent marks which are specified to be canopy volumes.

We address the disconnect between the available off the shelf methods and the requirements of our application through the use of a data simulation algorithm carefully constructed to approximate the underlying marked spatial point process and the relevant biological mechanisms of forest populations, such as growth and recruitment, using three subjectively selected subsets of the empirical data with varying point densities as a basis. We initialize the procedure by simulating the latent point process with a modification of the modeling scheme of \cite{mollerMechanisticSpatioTemporalPoint2016} for marked point processes, in order to include topographically derived covariates in the simulation of the mark distribution. We consider three point densities motivated by the range of densities observed in the RMBL dataset. The point densities are .04, .06, and .08, which we describe as low, medium, and high, respectively, throughout the remainder of this section. We note that the simulated data is constructed to generate data from two files corresponding to the empirical data in our application, though the model is theoretically capable of performing linkage for more than two files (i.e. scans).

One of the key innovations of the \cite{mollerMechanisticSpatioTemporalPoint2016} approach is to equate a marked spatial point process with a spatio-temporal point process by ordering the marks and treating them as arrival times in a spatio-temporal process. For each selected density, we use the observed sizes from the 2015 dataset to generate the approximate arrival times of the points and then predict the mark associated with each point as a function of time, neighborhood characteristics, and topographic covariates in an iterative fashion until we obtain a point realization matching the intensity of the empirical reference pattern. We employ an embedded gradient boosted tree model, built using the `xgboost` package [\cite{chenXgboostExtremeGradient2023}] in `R`, to predict the marks given the set of derived features. The empirical data demonstrate a notable pattern of inhibition, or regularity, at the \qty[mode = text]{100}{\unit{\meter^2}} scale, so we include provisions for interpoint interaction as a function of size in the data generation procedure to capture this behavior. The interaction function for point patterns defined by regularity, such as a Strauss process, are often specified with a hard core radius such that points in the process cannot be within a certain radius of each other [\cite{leiningerBayesianAnalysisSpatial2014}]. In our process we assume a soft core interaction radius such that we allow points to violate the hard core interaction radius with low probability. All of the simulated data is generated over \qty[mode = text]{130}{\unit{\meter^2}} areas, and then restricted to the center \qty[mode = text]{100}{\unit{\meter^2}} area to account for possible edge effects in the point patterns. We use the raster images of the topographic covariates, provided by RMBL, to draw the location specific covariate values in order to simulate data that approximates the real data as closely as possible.

To accurately reflect the biological mechanism of juvenile recruitment (i.e. the seeding of offspring trees) over time, we generate the number and locations of potential recruits according to the realized parent point process. Each parent point is assigned a number of recruits based on its size and the locations of recruits are modeled as arising from a $\text{t}\left(1\right)$ distribution centered at the parent point. The marks for the recruits are simulated from a heavily right-skewed scaled Beta distribution bounded by the minimum size observed in the distribution of the parent points in order to capture the fact that a relatively small number of recruits survive long enough to be identified. We note that the LiDAR process used to collect the empirical data has a height detection threshold of approximately \qty[mode = text]{2}{\unit{\meter}}, and so empirical data for the size distribution of smaller trees was unavailable. However, the mechanics of recruitment are well studied, and we incorporated relevant domain knowledge in the construction of our mechanism allowing larger individuals to seed more potential recruits using a sampling mechanism incorporating the individual's proportion of the total biomass contribution as the sampling weight. \cite{johnsonCanopyTreeDensity2021} provide a thorough discussion of the mechanisms involved in the recruitment processes of conifer species which we leverage in our data generating process.

We proceed in generating the observed data from two time points by applying a simplified growth model to appropriate transformations of the latent point configuration. For purposes of illustration, we consider a growth model with the same mean structure as the model presented in Section \ref{section3.2}, but we assume a standard Gaussian error process instead of the Skewed t process. We introduce noise in the observed locations according to the data process of the spatial record linkage model in Section \ref{section3.1} such that each observed location is generated from a bivariate normal distribution centered at the latent parent point with measurement error $\sigma^2$. Finally, we translate and rotate the points to achieve the final spatial configurations for each file. Given the observed marks for the points from the first file, for each point we predict the growth from the first observed time to the second according to the Michaelis-Menten style mean function $\mu$ with measurement error $\tau^2$. We note that growth is also predicted for the generated recruits, but without the measurement error component as these points are technically unobserved in the first file due to their sizes being below the detection threshold. The final set of observed data from two files is obtained by truncating the generated patterns to the center \qty[mode = text]{100}{\unit{\meter^2}} area. We apply the outlined simulation framework to produce a collection of datasets with known generating parameters and linkage structure as a baseline for assessing model performance, in the absence of a field inventory validation dataset, with varying levels of measurement error deemed to be plausible. A comparison of the simulated and empirical data for a \qty[mode = text]{100}{\unit{\meter^2}} medium density subset may be seen in Figure \ref{pp_comp_plot}. Additional discussion of the data generation algorithm and underlying assumptions may be found in Appendix D of the Supplementary Materials.

\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/med_dens_data_comp_plot.png"}
\caption{Comparison of the data from a medium density \qty[mode = text]{100}{\unit{\meter^2}} subset where plot (a) is the simulated data and plot (b) is the empirical data subset used to build the predictive model for the medium density validation data.}
\label{pp_comp_plot}
\end{figure}


\subsection{Simulation Performance}\label{section6.2}

In this section, we assess the performance of the linkage-averaging two-stage modeling approach on data generated using the simulation scheme discussed in Section \ref{section6.1}. We are able to gauge the efficacy of both the record linkage model and the downstream growth model given that the true linkage structure and parameter values used to generate the simulated data are known. We consider the performance of the model on 100 simulated datasets from low, medium, and high densities, which correspond to point intensities of approximately .04, .06, and .08 respectively over \qty[mode = text]{100}{\unit{\meter^2}} areas. We first consider the performance of the spatial record linkage model and then explore credible interval coverage rates for the growth model parameters across 100 simulated data sets for each density and with varying levels of noise in the observed locations. 

For the linkage model, we consider the metrics precision and recall, which are standard evaluation criteria for classification tasks defined as
\begin{equation}
\text{Precision} = \frac{\text{TP}}{\text{TP} + \text{FP}} \quad \text{\&} \quad \text{Recall} = \frac{\text{TP}}{\text{TP} + \text{FN}}, \nonumber
\end{equation}
where TP, FP, and FN are the number of true positives, false positives, and false negatives respectively. Precision measures the proportion of correctly identified matches out of all identified matches while recall measures the proportion of correctly identified matches out of all possible matches [\cite{alma991017200819703361}]. We summarize the linkage performance for $\alpha = 1$ over 100 datasets with known true linkage in Figure \ref{prec_rec_plot}. We considered three noise levels for the generating process for the observed spatial locations corresponding to $\sigma = .25$, $\sigma = .35$, and $\sigma = .45$ which we term small, medium, and large respectively. The model was run with $q=1.25$ when determining $N$ to match the value selected for the empirical data analysis. The results were similar for two alternative $\alpha$ values, which may be found in Appendix D of the Supplementary Materials.

\begin{figure}
\centering
\includegraphics[width = \textwidth]{"../plots/F23/prec_rec_ndm_la_comp.png"}
\caption{Plots comparing the precision (a) and recall (b) performance for the Linkage-Averaging and Nearest Distance Matching linkage approaches on 100 simulated datasets with known true linkage and with $\alpha = 1$.}
\label{prec_rec_plot}
\end{figure}

We note that the NDM algorithm only produces a single linkage estimate for each dataset and consequently a single estimate of precision and recall, while we obtain a full posterior distribution of the linkage for each dataset when using the spatial record linkage model. We see from Figure \ref{prec_rec_plot} that the average precision performance for the record linkage model tends to be a notable improvement over the NDM approach across the varying levels of density and noise. We note that the increase in precision for the record linkage model comes at cost in the form of reduced recall compared to the NDM approach. The NDM approach matches each point from the first file with a point in the second file, and resultingly captures more matches overall but the accuracy of those matches is reduced relative to the LA approach. We note that while both metrics are important gauges of the performance of the model, precision has a larger impact on the estimation of the downstream model parameters which is our primary objective.

We next consider the performance of the downstream growth model in terms of nominal coverage rates for 90% credible intervals for the growth model parameters of interest. We examine the same density, noise, and $\alpha$ settings as for the linkage model with growth parameter values $\gamma = 12$, $\bmbeta = \bbmx 3& .5& -.5& .5& -.5 \ebmx^\mT$, and $\tau^2 = .5$. Our prior specifications for overlapping parameters match those we use in the real data application to provide as direct an analogue between the two modeling scenarios as possible. The coverage results for the regression parameters over the 100 datasets for each setting may be found in Table \ref{growth_cov_table}. 


\begin{table}
\caption{Empirical coverage rates for 90\% credible intervals for covariate parameters of the downstream growth model across the true linkage, linkage-averaging, and nearest distance matching linkage approaches. We consider the coverage over 100 datasets for each setting with $\alpha = 1$ where the bolded coverages are closest to the nominal level (excluding the true linkage).}
\label{growth_cov_table}
\centering
\begin{tabular}[t]{lllccccc}
\toprule
\multicolumn{3}{c}{\textbf{ }} & \multicolumn{5}{c}{\textbf{Empirical Coverage by Parameter}} \\
\cmidrule(l{3pt}r{3pt}){4-8}
Density & Noise & Linkage Approach & $\beta_0$ & $\beta_1$ & $\beta_2$ & $\beta_3$ & $\beta_4$\\
\midrule
 &  & TL & 0.90 & 0.86 & 0.92 & 0.87 & 0.85\\
\cmidrule{3-8}
 &  & LA & \textbf{0.89} & \textbf{0.90} & \textbf{0.95} & \textbf{0.94} & \textbf{0.88}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Small} & NDM & 0.38 & 0.75 & \textbf{0.85} & 0.80 & 0.72\\
\cmidrule{2-8}
 &  & TL & 0.83 & 0.92 & 0.89 & 0.92 & 0.88\\
\cmidrule{3-8}
 &  & LA & \textbf{0.80} & \textbf{0.92} & \textbf{0.92} & \textbf{0.92} & \textbf{0.91}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Medium} & NDM & 0.20 & 0.75 & 0.84 & 0.86 & 0.83\\
\cmidrule{2-8}
 &  & TL & 0.90 & 0.92 & 0.93 & 0.94 & 0.89\\
\cmidrule{3-8}
 &  & LA & \textbf{0.76} & \textbf{0.98} & 1.00 & 0.95 & \textbf{0.97}\\
\cmidrule{3-8}
\multirow{-9}{*}[4\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Low} & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Large} & NDM & 0.08 & 0.79 & \textbf{0.85} & \textbf{0.87} & 0.82\\
\cmidrule{1-8}
 &  & TL & 0.91 & 0.88 & 0.94 & 0.92 & 0.92\\
\cmidrule{3-8}
 &  & LA & \textbf{0.89} & \textbf{0.88} & \textbf{0.95} & 0.94 & \textbf{0.93}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Small} & NDM & 0.36 & 0.64 & 0.83 & \textbf{0.92} & 0.79\\
\cmidrule{2-8}
 &  & TL & 0.92 & 0.89 & 0.94 & 0.97 & 0.93\\
\cmidrule{3-8}
 &  & LA & \textbf{0.84} & \textbf{0.90} & 0.98 & 0.98 & \textbf{0.95}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Medium} & NDM & 0.10 & 0.65 & \textbf{0.91} & \textbf{0.86} & 0.80\\
\cmidrule{2-8}
 &  & TL & 0.84 & 0.85 & 0.90 & 0.88 & 0.90\\
\cmidrule{3-8}
 &  & LA & \textbf{0.38} & \textbf{0.96} & 1.00 & 0.99 & 0.98\\
\cmidrule{3-8}
\multirow{-9}{*}[4\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Medium} & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Large} & NDM & 0.01 & 0.74 & \textbf{0.94} & \textbf{0.87} & \textbf{0.85}\\
\cmidrule{1-8}
 &  & TL & 0.83 & 0.87 & 0.93 & 0.94 & 0.85\\
\cmidrule{3-8}
 &  & LA & \textbf{0.79} & \textbf{0.88} & \textbf{0.94} & \textbf{0.95} & \textbf{0.88}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Small} & NDM & 0.30 & 0.74 & 0.95 & 0.82 & 0.66\\
\cmidrule{2-8}
 &  & TL & 0.85 & 0.90 & 0.84 & 0.91 & 0.83\\
\cmidrule{3-8}
 &  & LA & \textbf{0.81} & \textbf{0.90} & 0.97 & 1.00 & \textbf{0.92}\\
\cmidrule{3-8}
 & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Medium} & NDM & 0.16 & 0.64 & \textbf{0.96} & \textbf{0.89} & 0.67\\
\cmidrule{2-8}
 &  & TL & 0.81 & 0.83 & 0.92 & 0.97 & 0.88\\
\cmidrule{3-8}
 &  & LA & \textbf{0.37} & \textbf{0.97} & 1.00 & 1.00 & 1.00\\
\cmidrule{3-8}
\multirow{-9}{*}[4\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash High} & \multirow{-3}{*}[1\dimexpr\aboverulesep+\belowrulesep+\cmidrulewidth]{\raggedright\arraybackslash Large} & NDM & 0.03 & 0.82 & \textbf{0.99} & \textbf{0.96} & \textbf{0.83}\\
\bottomrule
\end{tabular}
\end{table}

We note that the coverage rates for the true linkage model are consistently around the 90% nominal coverage rate, which serves as the gold standard for the growth model performance. Comparing the linkage-averaging and nearest distance matching approaches, we see that the LA approach tends to outperform the NDM approach and often by a substantial margin. In the instances where the NDM coverage is closer to the nominal level, the coverage for the LA approach is generally more conservative due to the uncertainty propagation from the linkage stage of the modeling pipeline. These results are in line with our expectations regarding the performance of the different linkage approaches, and provide evidence that the two-stage linkage-averaging framework can reliably recover the parameters of interest from a downstream model. The results for $\alpha = 2$ and $\alpha = 3$ were similar for the growth model and may be found in Appendix D of the Supplementary Materials.


\section{Discussion and Future Work}\label{section7}

In this paper we have established a two-stage modeling framework built around a record linkage model for spatial location data which serves as the first step in a modeling pipeline constructed for multi-temporal location data. We demonstrated the efficiency and scalability of this approach for analyzing LiDAR derived individual tree characteristic data and provided a general schematic for using the linkage-averaging approach for two-stage modeling to obtain equivalent inference for the downstream model parameters to the marginal inference obtained from a joint model for the linkage, latent spatial process, and downstream model. This framework enables researchers to investigate growth trends as a function of topographic information at a spatial scale that was previously difficult to achieve and provides flexibility in examining a variety of downstream models for different modeling objectives. It would also be straight forward to extend for use in a Bayesian model averaging construction, as introduced by \cite{rafteryBayesianModelAveraging1997}, when considering a variety of candidate models for the same downstream modeling objective in lieu of a model selection procedure, as we employed in this application.

We applied this two-stage framework to investigate the population growth curves of conifer species on Snodgrass Mountain in the Southern Rocky Mountains of Colorado. We were able to quantify the impact of several key topographic covariates that serve as proxies for energy and water availability, which have been hypothesized to be limiting factors on growth for conifer species in this region. We demonstrated the effectiveness of our modeling approach in a series of numerical experiments on simulated data, in the absence of a ground truth dataset, and implemented a simulation framework for generating data arising from a multi-temporal process as a function of the data model from the linkage model and a general downstream growth model. This approach provides researchers with an alternative tool for model testing and validation in the absence of data with known linkage structure and degrees of measurement error from the various processes involved.

While our modeling approach is flexible and scalable, it can be sensitive to the specification of hyperparameters, like the maximum number of unique individuals across datasets, in facilitating the linkage. There is also a clear relationship with the amount of noise in the observed spatial locations and the performance of the linkage model, so care must be taken when considering the efficacy of a record linkage approach with extremely noisy data. Our modeling approach attempts to decompose the observed distortions in the data to more accurately address the possible sources of error, but these mechanisms are somewhat dependent on the spatial scale of the data (i.e. systematic rotation in a scan). We also note that while the linkage-averaging approach gives researchers a high degree of freedom, a joint modeling approach where the downstream modeling objective influences the linkage will likely lead to improved performance across the modeling pipeline if the downstream task can be well specified. In our future work, we plan to explore the viability of a joint modeling approach for similar problems which depend on multi-temporal spatial location data. 
